<template>
  <div
    role="presentation"
    class="compact-messages-preview"
    :class="{
      'compact-messages-no-borders': settings.no_borders,
    }"
    :style="cssVariables({
      '--message-padding': settings.message_padding + 'px',
      '--comment-padding': settings.comment_padding + 'px',
    })"
  >
    <template v-for="_ of [1, 2]">
      <div class="compact-messages-message">
        <div v-show="!settings.hide_icons" class="compact-messages-message-icon"></div>
        <div>
          <div class="compact-messages-text-placeholder"></div>
          <div class="compact-messages-comment">
            <div class="compact-messages-avatar"></div>
            <div class="compact-messages-comment-bubble">
              <div class="compact-messages-text-placeholder"></div>
            </div>
          </div>
        </div>
        <div class="compact-messages-text-placeholder compact-messages-message-date"></div>
      </div>
      <div v-for="_ of [1, 2]" class="compact-messages-message">
        <div v-show="!settings.hide_icons" class="compact-messages-message-icon"></div>
        <div class="compact-messages-text-placeholder"></div>
        <div class="compact-messages-text-placeholder compact-messages-message-date"></div>
      </div>
    </template>
  </div>
</template>

<style>
  .compact-messages-preview {
    margin-top: 10px;
    width: 512px;
    height: 200px;
    overflow: hidden;
    background-color: var(--navigation-background);
    border: 1px solid var(--control-border);
    border-radius: 4px;
  }

  .compact-messages-message {
    display: flex;
    padding: var(--message-padding);
    border-bottom: 1px solid var(--control-border);
  }

  .compact-messages-message:last-child,
  .compact-messages-no-borders .compact-messages-message {
    border: none;
  }

  .compact-messages-message-icon {
    margin-block: 2px;
    margin-inline-end: 16px;
    width: 20px;
    height: 20px;
    background-color: #4d97ff;
    border-radius: 10px;
    opacity: 0.25;
  }

  .compact-messages-text-placeholder {
    margin: 8px 0;
    --length: 15;
    width: calc(6px * var(--length));
    min-width: 8px;
    height: 8px;
    background-color: currentColor;
    border-radius: 8px;
    opacity: 0.75;
  }

  .compact-messages-message-date {
    margin-inline-start: auto;
    --length: 8;
  }

  .compact-messages-comment {
    margin-top: 16px;
    margin-bottom: 4px;
    display: flex;
    align-items: flex-start;
  }

  .compact-messages-avatar {
    width: 40px;
    height: 40px;
    background-color: #4d97ff;
    border-radius: 3px;
    opacity: 0.25;
  }

  .compact-messages-comment-bubble {
    margin-inline-start: 24px;
    position: relative;
    padding: var(--comment-padding);
    border: 1px solid var(--control-border);
    border-radius: 0 5px 5px 5px;
  }

  [dir="rtl"] .compact-messages-comment-bubble {
    border-radius: 5px 0 5px 5px;
  }

  .compact-messages-comment-bubble::before,
  .compact-messages-comment-bubble::after {
    content: "";
    position: absolute;
    display: block;
  }

  .compact-messages-comment-bubble::before {
    top: -1px;
    left: -13px;
    border-bottom: 12px solid var(--control-border);
    border-left: 13px solid var(--control-border);
    border-radius: 0 0 0 13px;
  }

  [dir="rtl"] .compact-messages-comment-bubble::before {
    left: auto;
    right: -13px;
    border-radius: 0 0 13px 0;
  }

  .compact-messages-comment-bubble::after {
    top: 0;
    left: -12px;
    border-bottom: 10px solid var(--navigation-background);
    border-left: 12px solid var(--navigation-background);
    border-radius: 0 0 0 12px;
  }

  [dir="rtl"] .compact-messages-comment-bubble::after {
    left: auto;
    right: -12px;
    border-radius: 0 0 12px 0;
  }
</style>
